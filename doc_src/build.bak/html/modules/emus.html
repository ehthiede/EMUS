

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>emus module &mdash; emus  documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="emus  documentation" href="../index.html"/>
        <link rel="up" title="EMUS Modules" href="index.html"/>
        <link rel="next" title="emusroutines module" href="emusroutines.html"/>
        <link rel="prev" title="avar module" href="avar.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> emus</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#loading-from-wham-like-formats">Loading from WHAM-like Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#calculating-the-pmf">Calculating the PMF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#estimating-window-partition-functions">Estimating Window Partition Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#calculating-averages">Calculating Averages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../datastructures.html">Data Structures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../datastructures.html#parameters-for-harmonic-umbrellas">Parameters for Harmonic Umbrellas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastructures.html#data-from-sampling">Data from Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datastructures.html#other-conventions">Other Conventions</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">EMUS Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="autocorrelation.html">autocorrelation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="avar.html">avar module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">emus module</a></li>
<li class="toctree-l2"><a class="reference internal" href="emusroutines.html">emusroutines module</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg.html">linalg module</a></li>
<li class="toctree-l2"><a class="reference internal" href="usutils.html">usutils module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../test.html">test</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">emus</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">EMUS Modules</a> &raquo;</li>
      
    <li>emus module</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/modules/emus.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="module-emus">
<span id="emus-module"></span><h1>emus module<a class="headerlink" href="#module-emus" title="Permalink to this headline">¶</a></h1>
<p>Module containing the emus object.</p>
<dl class="class">
<dt id="emus.emus">
<em class="property">class </em><code class="descclassname">emus.</code><code class="descname">emus</code><span class="sig-paren">(</span><em>psis</em>, <em>cv_trajs=None</em>, <em>neighbors=None</em>, <em>k_B=0.0019872041</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emus.html#emus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emus.emus" title="Permalink to this definition">¶</a></dt>
<dd><p>Class containing methods and data for the EMUS algorithm.  An EMUS object has the following data structures which can be interacted with or modified:</p>
<p>self.psis (3D array): array containing values of the biases in each state.
self.cv_trajs (2D Array): array containing the trajectories in cv space.  None if not used.
self.z (1d array): array containing the normalization constants.  Calculated according to the first iteration of EMUS. 
self.F (2d array): F matrix for the first iteration of EMUS.
self.iats (1d array): array containing integrated autocorrelation times of <span class="math">\(\psi_{ii}(x)\)</span> in each window.</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#emus.emus.avar_zfe" title="emus.emus.avar_zfe"><code class="xref py py-obj docutils literal"><span class="pre">avar_zfe</span></code></a>(state_1,&nbsp;state_2)</td>
<td>Calculates the asymptotic variance for the free energy difference between the two states specified.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#emus.emus.calc_obs" title="emus.emus.calc_obs"><code class="xref py py-obj docutils literal"><span class="pre">calc_obs</span></code></a>(fdata[,&nbsp;z])</td>
<td>Estimates the average of an observable function.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#emus.emus.calc_pmf" title="emus.emus.calc_pmf"><code class="xref py py-obj docutils literal"><span class="pre">calc_pmf</span></code></a>(domain[,&nbsp;cv_trajs,&nbsp;nbins,&nbsp;kT,&nbsp;z])</td>
<td>Calculates the potential of mean force for the system.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#emus.emus.calc_zs" title="emus.emus.calc_zs"><code class="xref py py-obj docutils literal"><span class="pre">calc_zs</span></code></a>([nMBAR,&nbsp;tol,&nbsp;use_iats,&nbsp;iats])</td>
<td>Calculates the normalization constants for the states.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="emus.emus.avar_zfe">
<code class="descname">avar_zfe</code><span class="sig-paren">(</span><em>state_1</em>, <em>state_2</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emus.html#emus.avar_zfe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emus.emus.avar_zfe" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the asymptotic variance for the free energy difference between the two states specified.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>state_1</strong> : int</p>
<blockquote>
<div><p>Index of the first state.</p>
</div></blockquote>
<p><strong>state_2</strong> : int</p>
<blockquote>
<div><p>Index of the second state.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>errs</strong> : 1D array</p>
<blockquote class="last">
<div><p>Array containing each state&#8217;s contribution to the asymptotic error.  The total asymptotic error is taken by summing the entries.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emus.emus.calc_obs">
<code class="descname">calc_obs</code><span class="sig-paren">(</span><em>fdata</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emus.html#emus.calc_obs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emus.emus.calc_obs" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the average of an observable function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fdata</strong> : 2d array-like</p>
<blockquote>
<div><p>Two dimensional data structure where the first dimension corresponds to the state index, and the second to the value of the observable at that time point.  Must have the same number of data-points as the collective variable trajectory.</p>
</div></blockquote>
<p><strong>z</strong> : 1D array, optional</p>
<blockquote>
<div><p>User-provided values for the normalization constants. If not provided, uses values from the first iteration.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>favg</strong> : float</p>
<blockquote class="last">
<div><p>The estimated average of the observable.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emus.emus.calc_pmf">
<code class="descname">calc_pmf</code><span class="sig-paren">(</span><em>domain</em>, <em>cv_trajs=None</em>, <em>nbins=100</em>, <em>kT=1.0</em>, <em>z=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emus.html#emus.calc_pmf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emus.emus.calc_pmf" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the potential of mean force for the system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>domain</strong> : tuple</p>
<blockquote>
<div><p>Tuple containing the dimensions of the space over which to construct the pmf, e.g. (-180,180) or ((0,1),(-3.14,3.14))</p>
</div></blockquote>
<p><strong>nbins</strong> : int or tuple, optional</p>
<blockquote>
<div><p>Number of bins to use.  If int, uses that many bins in each dimension.  If tuple, e.g. (100,20), uses 100 bins in the first dimension and 20 in the second.</p>
</div></blockquote>
<p><strong>cvtrajectories</strong> : 2D array-like, optional</p>
<blockquote>
<div><p>Two dimensional data structure with the trajectories in cv space.  The first dimension is the state where the data was collected, and the second is the value in cv space.  If not provided, uses trajectory given in the constructor.</p>
</div></blockquote>
<p><strong>z</strong> : 1D array, optional</p>
<blockquote>
<div><p>User-provided values for the normalization constants If not provided, uses values from the first iteration of EMUS.</p>
</div></blockquote>
<p><strong>kT</strong> : float, optional</p>
<blockquote>
<div><p>Value of kT to scale the PMF by.  If not provided, set to 1.0</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>pmf</strong> : nd array</p>
<blockquote class="last">
<div><p>Returns the potential of mean force as a d dimensional array, where d is the number of collective variables.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="emus.emus.calc_zs">
<code class="descname">calc_zs</code><span class="sig-paren">(</span><em>nMBAR=0</em>, <em>tol=1e-08</em>, <em>use_iats=False</em>, <em>iats=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/emus.html#emus.calc_zs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#emus.emus.calc_zs" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the normalization constants for the states.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>nMBAR</strong> : int, optional (default 0)</p>
<blockquote>
<div><p>Maximum number of MBAR iterations to perform.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional (default 1.0E-8)</p>
<blockquote>
<div><p>If the relative residual falls beneath the tolerance, the MBAR iteration is truncated.</p>
</div></blockquote>
<p><strong>use_iats</strong> : bool, optional</p>
<blockquote>
<div><p>If true, estimate integrated autocorrelation time in each MBAR iteration.  Likely unnecessary unless dynamics are expected to be drastically different in each state. If iats is provided, the iteration will use those rather than estimating them in each step.</p>
</div></blockquote>
<p><strong>iats</strong> : 1D array, optional</p>
<blockquote>
<div><p>Array of size L (no. states) with values of the integrated autocorrelation time estimated in each state.  These values will be used in each iteration.  Overrides use_iats.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>z</strong> : 1D array</p>
<blockquote>
<div><p>Values for the Normalization constant in each state.</p>
</div></blockquote>
<p><strong>F</strong> : 2D array</p>
<blockquote>
<div><p>Matrix to take the eigenvalue of for MBAR.</p>
</div></blockquote>
<p>iats 1D array</p>
<blockquote class="last">
<div><p>Estimated values of the autocorrelation time.  Only returned if use_iats is true.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="emusroutines.html" class="btn btn-neutral float-right" title="emusroutines module">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="avar.html" class="btn btn-neutral" title="avar module"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Erik H Thiede.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>