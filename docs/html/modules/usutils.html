

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>usutils module &mdash; emus  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="emus  documentation" href="../index.html"/>
        <link rel="up" title="EMUS Modules" href="index.html"/>
        <link rel="prev" title="linalg module" href="linalg.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> emus
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datastructures.html">Data Structures</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">EMUS Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="autocorrelation.html">autocorrelation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="avar.html">avar module</a></li>
<li class="toctree-l2"><a class="reference internal" href="emus.html">emus module</a></li>
<li class="toctree-l2"><a class="reference internal" href="linalg.html">linalg module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">usutils module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">emus</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">EMUS Modules</a> &raquo;</li>
      
    <li>usutils module</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/usutils.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-usutils">
<span id="usutils-module"></span><h1>usutils module<a class="headerlink" href="#module-usutils" title="Permalink to this headline">¶</a></h1>
<p>Module containing methods useful for analyzing umbrella sampling 
calculations that do not rely directly on the EMUS estimator.</p>
<dl class="function">
<dt id="usutils.calc_harmonic_psis">
<code class="descclassname">usutils.</code><code class="descname">calc_harmonic_psis</code><span class="sig-paren">(</span><em>cv_traj</em>, <em>centers</em>, <em>fks</em>, <em>kTs</em>, <em>period=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/usutils.html#calc_harmonic_psis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#usutils.calc_harmonic_psis" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the values of each bias function from a trajectory of points in a single window.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cv_traj</strong> : array-like</p>
<blockquote>
<div><p>Trajectory in collective variable space.  Can be 1-dimensional (one cv) or 2-dimensional (many cvs).  The first dimension is the time index, and (optional) second corresponds to the collective variable.</p>
</div></blockquote>
<p><strong>centers</strong> : array-like</p>
<blockquote>
<div><p>The locations of the centers of each window.  The first dimension is the window index, and the (optional) second is the collective variable index.</p>
</div></blockquote>
<p><strong>fks</strong> : 2D array-like or scalar</p>
<blockquote>
<div><p>If array or list, data structure where the first dimension corresponds to the window index and the second corresponds to the collective variable.  If scalar, windows are assumed to have that force constant in every dimension.</p>
</div></blockquote>
<p><strong>kTs</strong> : 2D array-like or scalar</p>
<blockquote>
<div><p>1D array with the Boltzmann factor or a single value which will be used in all windows.  Default value is the scalar 1.</p>
</div></blockquote>
<p><strong>period</strong> : 1D array-like or float, optional</p>
<blockquote>
<div><p>Period of the collective variable e.g. 360 for an angle. If None, all collective variables are taken to be aperiodic.  If scalar, assumed to be period of each collective variable. If 1D iterable with each value a scalar or None, each cv has periodicity of that size.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>psis</strong> : 2D array</p>
<blockquote class="last">
<div><p>The values of the bias functions evaluated each window and timepoint.  See <a class="reference external" href="../datastructures.html#data-from-sampling">datastructures</a> for more information.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="usutils.data_from_meta">
<code class="descclassname">usutils.</code><code class="descname">data_from_meta</code><span class="sig-paren">(</span><em>filepath</em>, <em>dim</em>, <em>T=1.0</em>, <em>k_B=1.0</em>, <em>nsig=None</em>, <em>period=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/usutils.html#data_from_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#usutils.data_from_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads collective variable data from as tabulated by a meta file of the same format used in Grossfield&#8217;s implementation of the WHAM algorithm, and calculates the value of the biasing functions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filepath</strong> : string</p>
<blockquote>
<div><p>The path to the meta file.</p>
</div></blockquote>
<p><strong>dim</strong> : int</p>
<blockquote>
<div><p>The number of dimensions of the cv space.</p>
</div></blockquote>
<p><strong>T</strong> : scalar, optional</p>
<blockquote>
<div><p>Temperature of the system if not provided in the meta file.</p>
</div></blockquote>
<p><strong>k_B</strong> : scalar, optional</p>
<blockquote>
<div><p>Boltzmann Constant for the system. Default is in natural units (1.0)</p>
</div></blockquote>
<p><strong>nsig</strong> : scalar or None, optional</p>
<blockquote>
<div><p>Number of standard deviations of the gaussians to include in the neighborlist.If None, does not use neighbor lists.</p>
</div></blockquote>
<p><strong>period</strong> : 1D array-like or float, optional</p>
<blockquote>
<div><p>Variable with the periodicity information of the system.  See the Data Structures section of the documentation for a detailed explanation.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>psis</strong> : List of 2D arrays</p>
<blockquote class="last">
<div><p>The values of the bias functions evaluated each window and timepoint.  See <a class="reference external" href="../datastructures.html#data-from-sampling">datastructures</a> for more information.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="usutils.fxn_data_from_meta">
<code class="descclassname">usutils.</code><code class="descname">fxn_data_from_meta</code><span class="sig-paren">(</span><em>filepath</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/usutils.html#fxn_data_from_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#usutils.fxn_data_from_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the meta file associated with observable data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>filepath</strong> : string</p>
<blockquote>
<div><p>The path to the meta file containing the paths of the observable data.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>fxndata</strong> : List of 2D arrays</p>
<blockquote class="last">
<div><p>Three dimensional data structure containing observable information.  The first index corresponds to the observable being calculated, the second to the window index, and the third to the time point in the window.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="usutils.neighbors_harmonic">
<code class="descclassname">usutils.</code><code class="descname">neighbors_harmonic</code><span class="sig-paren">(</span><em>centers</em>, <em>fks</em>, <em>kTs=1.0</em>, <em>period=None</em>, <em>nsig=6</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/usutils.html#neighbors_harmonic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#usutils.neighbors_harmonic" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates neighborlist for harmonic windows.  Neighbors are chosen 
such that neighboring umbrellas are no more than nsig standard
deviations away on a flat potential.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>centers</strong> : 2D array-like</p>
<blockquote>
<div><p>The locations of the centers of each window.  The first dimension is the window index, and the second is the collective variable index.</p>
</div></blockquote>
<p><strong>fks</strong> : 2D array-like or scalar</p>
<blockquote>
<div><p>If array or list, data structure where the first dimension corresponds to the window index and the second corresponds to the collective variable.  If scalar, windows are assumed to have that force constant in every dimension.</p>
</div></blockquote>
<p><strong>kTs</strong> : 2D array-like or scalar</p>
<blockquote>
<div><p>1D array with the Boltzmann factor or a single value which will be used in all windows.  Default value is the scalar 1.</p>
</div></blockquote>
<p><strong>period</strong> : 1D array-like or float</p>
<blockquote>
<div><p>Period of the collective variable e.g. 360 for an angle. If None, all collective variables are taken to be aperiodic.  If scalar, assumed to be period of each collective variable. If 1D iterable with each value a scalar or None, each cv has periodicity of that size.</p>
</div></blockquote>
<p><strong>nsig</strong> : scalar</p>
<blockquote>
<div><p>Number of standard deviations of the gaussians to include in the neighborlist.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>nbrs</strong> : 2D list</p>
<blockquote class="last">
<div><p>List where element i is a list with the indices of all windows neighboring window i.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="usutils.unpack_nbrs">
<code class="descclassname">usutils.</code><code class="descname">unpack_nbrs</code><span class="sig-paren">(</span><em>compd_array</em>, <em>neighbors</em>, <em>L</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/usutils.html#unpack_nbrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#usutils.unpack_nbrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpacks an array of neighborlisted data.  Currently, assumes axis 0 is the compressed axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>compd_array</strong> : array-like</p>
<blockquote>
<div><p>The compressed array, calculated using neighborlists</p>
</div></blockquote>
<p><strong>neighbors</strong> : array-like</p>
<blockquote>
<div><p>The list or array of ints, containing the indices of the neighboring windows</p>
</div></blockquote>
<p><strong>L</strong> : int</p>
<blockquote>
<div><p>The total number of windows.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>expd_array</strong> : array-like</p>
<blockquote class="last">
<div><p>The expanded array of data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="linalg.html" class="btn btn-neutral" title="linalg module" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Erik H Thiede.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>